\documentclass[../../../main_math.tex]{subfiles}

%break on finite difference equations

\begin{document}
\changecolor{NIPDE}
\begin{multicols}{2}[\section{Numerical integration of partial differential equations}]
  \subsection{Finite difference schemes}
  \subsubsection{Introduction}
  \begin{definition}
    A linear system of $n$ first order of pdes for $\vf{u}(t,x)$ is a system of the form: $$\vf{A}(t,x)\vf{u}_t+\vf{B}(t,x)\vf{u}_x=\vf{C}(t,x)\vf{u}+\vf{D}(t,x)$$
    for certain matrices $\vf{A},\vf{B},\vf{C}, \vf{D}\in \mathcal{M}_q(\RR)$. The system is called \emph{hyperbolic} if $\vf{A}^{-1}\vf{B}$ is diagonalizable.
  \end{definition}
  \begin{definition}
    Let $n\in\NN$, $m\in\ZZ$, $h,k>0$ and $\vf{u}:\RR^2\rightarrow\RR^q$ be a function. We define $\vf{u}_m^n:=\vf{u}(t_n,x_m)$, where $(t_n, x_m):=(nk,x_0+mh)$, $x_0\in\RR$. We denoted by $\vf{v}_m^n$ an approximation to $\vf{u}_m^n$. The set of points $G:=\{(t_n,x_m):n\in\NN,\ m\in\ZZ\}$ is called a \emph{grid}.
  \end{definition}
  \begin{definition}
    Let $G$ be a grid. A \emph{finite difference scheme} is a function $$\function{\vf{v}}{G}{\RR}{(t_n,x_m)}{\vf{v}_m^n}$$
    that aims to approximate $\vf{u}_m^n$, where $\vf{u}:\RR^2\rightarrow\RR^q$ is a function. Here $\vf{v}_m^n$ is a function of $\vf{v}_m^{n-j}$, $m\in\ZZ$, $j=0,\ldots,J-1$. The number $J$ is called \emph{number of steps}. If $J=1$, we say that the scheme is a \emph{one-step} scheme. Otherwise we say that the scheme is \emph{multi-step}.
  \end{definition}
  \begin{proposition}
    Consider the one dimensional homogeneous traffic equation of constant coefficients
    \begin{equation}\label{NIPDE:traffic}
      u_t+au_x=f
    \end{equation}
    where $a\in\RR$ and $f$ is a function.
    The following are satisfied:
    \begin{enumerate}
      \item $\displaystyle\frac{u_m^{n+1}-u_m^n}{k}+a\frac{u_{m+1}^n-u_m^n}{h}+\O{k}+\O{h}=f_m^n$
      \item $\displaystyle\frac{u_m^{n+1}-u_m^n}{k}+a\frac{u_{m}^n-u_{m-1}^n}{h}+\O{k}+\O{h}=f_m^n$
      \item $\displaystyle\frac{u_m^{n+1}-u_m^n}{k}+a\frac{u_{m+1}^n-u_{m-1}^n}{2h}+\O{k}+\O{h^2}=f_m^n$
      \item \emph{Leapfrog scheme}:
            \begin{multline*}
              \frac{u_m^{n+1}-u_m^{n-1}}{2k}+a\frac{u_{m+1}^n-u_{m-1}^n}{2h}+\\+\O{k^2}+\O{h^2}=f_m^n
            \end{multline*}
      \item \emph{Lax-Friedrichs scheme}:
            \begin{multline*}
              \frac{u_m^{n+1}-\frac{1}{2}(u_{m+1}^n+u_{m-1}^n)}{k}+a\frac{u_{m+1}^n-u_{m-1}^n}{2h} + \\ + \O{k}+\O{\frac{h^2}{k}}+\O{h^2}=f_m^n
            \end{multline*}
    \end{enumerate}
  \end{proposition}
  \begin{sproof}
    Use the Taylor expansion of $u(t,x)$.
  \end{sproof}
  \begin{corollary}
    Consider the traffic equation of \mcref{NIPDE:traffic} and let $\lambda:=k/h$. Then, we have the following schemes for approximating the solution:
    \begin{enumerate}
      \item $\displaystyle v_m^{n+1}=(1+\lambda a)v_m^n-\lambda av_{m+1}^n+f_m^n$
      \item $\displaystyle v_m^{n+1}=(1-\lambda a)v_m^n+\lambda av_{m+1}^n+f_m^n$
      \item $\displaystyle v_m^{n+1}=v_m^n-\frac{\lambda a}{2}v_{m+1}^n+\frac{\lambda a}{2}v_{m-1}^n+f_m^n$
      \item Leapfrog scheme: $$v_m^{n+1}=v_m^{n-1}-\lambda av_{m+1}^n+\lambda av_{m-1}^n+f_m^n$$
      \item Lax-Friedrichs scheme: $$v_m^{n+1}=\frac{1}{2}\left((1-\lambda a)v_{m+1}^n+(1+\lambda a)v_{m-1}^n\right)+f_m^n$$
    \end{enumerate}
  \end{corollary}
  \subsubsection{Convergence and consistency}
  \begin{definition}
    A \emph{stability region} is a set $\Lambda\subseteq{\RR_>0}^2$ such that $(0,0)\in\Lambda'$, that is $(0,0)$ in an accumulation point.
  \end{definition}
  \begin{definition}
    Let $(G_j)$ be a sequence of grids such that the time and space steps $k_j,h_j>0$ of each one satisfy $\displaystyle \lim_{j\to\infty}k_j=\lim_{j\to\infty}h_j=0$.
    We say that a finite difference scheme $v$ approximating a pde with initial condition $u_0(x)$ is \emph{unconditionally convergent} if for any solution $u(x,t)$ to the pde we have:
    \begin{itemize}
      \item For all $x\in\domain u_0$ and all increasing sequence $(m_j)\in\NN$ such that $(\cdot,x_{m_j})\in G_j$ and $\displaystyle\lim_{j\to\infty} x_{m_j}=x$, we have $\displaystyle\lim_{j\to\infty} v_{m_j}^0=u_0(x)$.
      \item For all $(t,x)\in\domain u$ and all increasing sequences $(m_j),(n_j)\in\NN$ such that $(t_{n_j},x_{m_j})\in G_j$ and $\displaystyle\lim_{j\to\infty} x_{m_j}=x$, $\displaystyle\lim_{j\to\infty} t_{n_j}=t$, we have $\displaystyle\lim_{j\to\infty} v_{m_j}^{n_j}=u(t,x)$.
    \end{itemize}
    The scheme is \emph{conditionally convergent} if $\forall j\in\NN$, $(k_j,h_j)\in\Lambda$, for some stability region $\Lambda$.
  \end{definition}
  \begin{definition}
    Let $P$ be a partial differential operator and $\vf{f}$ be a function. Given the pde $P\vf{u}=\vf{f}$ and a finite difference scheme $P_{k,h}\vf{v}=R_{k,h}\vf{f}$ with $R_{k,h}\vf{1}=\vf{1}$, we say that the scheme is \emph{consistent} with the pde if for any smooth function $\vf\phi(t,x)$ we have: $$\lim_{k,h\to 0}R_{k,h}P\vf\phi-P_{k,h}\vf\phi=\vf{0}$$
    where the convergence is pointwise at each point $(t,x)$ in the domain of solutions. We say that the consistency is of order $(p,q)$ in time and space or order $r$ in $k=\lambda(h)$ if: $$\lim_{k,h\to 0}R_{k,h}P\vf\phi-P_{k,h}\vf\phi=\O{k^p}+\O{h^q}=\O{h^r}$$  The consistency is a \emph{conditional consistency} if the limit is for $(k,h)\in \Lambda$, for some stability region $\Lambda$.
  \end{definition}
  \begin{lemma}
    The Lax-Friedrichs scheme is consistent if and only if $\displaystyle\lim_{h,k\to 0}\frac{h^2}{k}=0$.
  \end{lemma}
  \subsubsection{Stability}
  \begin{definition}
    Let $P_{k,h}\vf{v}=0$ be a finite difference scheme with $J$ steps and $\Lambda$ be a stability region. We say that it is \emph{stable} is given $T>0$, there exists $C_T>0$ such that for any grid with $(k,h)\in \Lambda$ and for any initial values $\vf{v}_m^j$, $m\in\ZZ$, $j=0,\ldots,J-1$ we have $$\sum_{m\in\ZZ}\norm{\vf{v}_m^n}^2\leq C_T\sum_{j=0}^{J-1}\sum_{m\in\ZZ}\norm{\vf{v}_m^j}^2$$ for all $n\in\NN$ such that $0\leq nk\leq T$.
  \end{definition}
  \begin{lemma}
    If finite difference scheme of the form of $$\vf{v}_m^{n+1}=\alpha \vf{v}_m^n+\beta \vf{v}_{m+1}^n$$ satisfies $\abs{\alpha}+\abs{\beta}\leq 1$, then it is stable.
  \end{lemma}
  \begin{sproof}
    \begin{align*}
      \sum_{m\in\ZZ}\norm{\vf{v}_m^{n+1}}^2 & \leq \sum_{m\in\ZZ}\left(\abs{\alpha}^2\norm{\vf{v}_m^n}^2+2\abs{\alpha}\abs{\beta}\norm{\vf{v}_m^n}\cdot\right. \\
                                            & \hspace{2.5cm}\cdot\norm{\vf{v}_{m+1}^n}+\left.\abs{\beta}^2\norm{\vf{v}_{m+1}^n}^2\right)
      \\
                                            & \leq \sum_{m\in\ZZ}\left(\abs{\alpha}^2\norm{\vf{v}_m^n}^2+\abs{\alpha}\abs{\beta}(\norm{\vf{v}_m^n}^2 \right.+  \\
                                            & \hspace{2cm}\left.+\norm{\vf{v}_{m+1}^n}^2)+\abs{\beta}^2\norm{\vf{v}_{m+1}^n}^2\right)                          \\
                                            & = \sum_{m\in\ZZ}\left(\abs{\alpha}^2+2\abs{\alpha}\abs{\beta}+\abs{\beta}^2\right)\norm{\vf{v}_{m}^n}^2          \\
                                            & ={(\abs{\alpha}+\abs{\beta})}^2 \sum_{m\in\ZZ}\norm{\vf{v}_{m}^n}^2                                              \\
                                            & \leq{(\abs{\alpha}+\abs{\beta})}^{2(n+1)} \sum_{m\in\ZZ}\norm{\vf{v}_{m}^0}^2
    \end{align*}
  \end{sproof}
  \begin{theorem}[Courant-Friedrichs-Lewy condition]
    Consider the traffic equation $$\vf{u}_t+\vf{A}\vf{u}_x=0$$ with $\vf{A}\in\mathcal{M}_q(\RR)$ and a finite difference scheme of the form $$\vf{v}_m^{n+1}=\alpha \vf{v}_{m-1}^n+\beta \vf{v}_m^n+\gamma \vf{v}_{m+1}^n$$ with $k/h=\lambda=\const$ Then, if the scheme is convergent, we have $\abs{a_i\lambda}\leq 1$ $\forall a_i\in\sigma(\vf{A})$.
  \end{theorem}
  \begin{proof}
    Suppose $\abs{a_i\lambda}>1$ for some eigenvalue $a_i$ and let $\vf{u}_0(x)=\vf{c}\indi{\{\abs{x}> \frac{1}{\abs{\lambda}}\}}$ with $\vf{c}=(c_1,\ldots,c_q)$ and $c_i\ne 0$. As shown in figure \mcref{NIPDE:courant-friedrichs-lewy_fig} the numerical solution at $\vf{u}(1,0)$ will have the $i$-th component always equal to 0, whereas in general the exact solution won't be.
    \begin{figure}[H]
      \centering
      \includestandalone[mode=image|tex,width=\linewidth]{Images/courant-friedrichs-lewy}
      \caption{Finite difference scheme (blue) versus the characteristic lines (in red). The arrows inward a bullet come from the points from which it depends.}
      \label{NIPDE:courant-friedrichs-lewy_fig}
    \end{figure}
  \end{proof}
  % \begin{theorem}
  %   There are no explicit, unconditionally stable, consistent finite difference schemes for hyperbolic systems of partial differential equations.
  % \end{theorem}
  \subsubsection{Von Neumann stability analysis}
  \begin{definition}
    Let $P_{k,h}{v}={f}$ be a finite difference scheme. For each $n\in\NN$, let ${\hat{v}}^n\in L^2\left(\left[-\frac{\pi}{h},\frac{\pi}{h}\right]\right)$ be the function defined as the Fourier series: $${\hat{v}}^n(\xi)=\sum_{m\in\ZZ}{v}_{m}^n\exp{-\ii m h \xi}$$ Hence $\displaystyle {v}_m^n=\frac{h}{2\pi}\int_{-\pi/h}^{\pi/h} {\hat{v}}^n(\xi)\exp{\ii mh \xi}\dd{\xi}$. We denote by ${v}^n:=({v}_m^n)\in\ell^2(\ZZ)$. We define the \emph{amplification factor} as the $2\pi$-periodic function in $\theta$, $g(\theta, k, h)$ that satisfies:
    $${\hat{v}}^{n+1}(\xi)=g(\xi h,k,h){\hat{v}}^n(\xi)$$
  \end{definition}
  \begin{theorem}
    Let $P_{k,h}{v}={f}$ be a one-step finite difference scheme with constant coefficients whose amplification factor $g(\theta,k,h)$ is continuous on $\RR\times\Lambda$, where $(k,h)\in\Lambda$ is a stability region. Then:
    \begin{enumerate}
      \item If $\exists K>0$ such that $\forall\theta\in\RR$ and $\forall(k,h)\in\Lambda$ we have $\abs{g(\theta,k,h)}\leq 1+Kk$, then the scheme is stable in $\Lambda$.
      \item If $\forall K>0$ and $\forall\varepsilon>0$ $\exists\theta\in\RR$ and $\exists(k,h)\in\Lambda$ with $k<\varepsilon$ such that $\abs{g(\theta, k,h)}>1+Kk$, then the scheme is unstable.
    \end{enumerate}
  \end{theorem}
  \begin{proof}
    \begin{enumerate}
      \item We have that $${\hat{v}}^{n}(\xi)={(g(\xi h,k,h))}^n{\hat{v}}^0(\xi)$$ Therefore applying twice the \mcref{MA:parseval}:
            \begin{align*}
              {\norm{{v}^n}_2}^2 & =\sum_{m\in\ZZ}\abs{{v}_m^n}^2                                                      \\
                                 & =\frac{h}{2\pi}\int_{-\pi/h}^{\pi/h} \abs{\hat{v}^n(\xi)}^2\dd{\xi}                 \\
                                 & \leq{(1+Kk)}^{2n}\frac{h}{2\pi}\int_{-\pi/h}^{\pi/h} \abs{\hat{v}^0(\xi)}^2\dd{\xi} \\
                                 & ={(1+Kk)}^{2n} {\norm{{v}^0}_2}^2
            \end{align*}
            And note that $\forall T>0$ with $nk\leq T$ we have that:
            \begin{multline*}
              {(1+Kk)}^{2n}\leq{(1+Kk)}^{2\frac{T}{k}}={\left({(1+Kk)}^\frac{1}{Kk}\right)}^{2 K T}\leq\\\leq \exp{2K T}=:C_T
            \end{multline*}
            because $\sup_{x>0}{(1+x)}^{1/x}=\exp{}$.
      \item Let $T\geq 2$, $K>0$, and $\theta_0,h,k$ be the ones of the hypothesis with $\varepsilon=\min(1,\frac{1}{K})$. Hence, $k\leq 1$ and $Kk\leq 1$. By the continuity of $g$, $\exists \theta_1,\theta_2\in\RR$ such that $\abs{g(\theta, k,h)}>1+Kk$ $\forall\theta\in[\theta_1,\theta_2]$. Let $\hat{v}^0(\xi):=\sqrt{\frac{2\pi}{h(\theta_2-\theta_1)}}\indi{\left[\frac{\theta_1}{h},\frac{\theta_2}{h}\right]}$ and denote $v^0:=(v_m^0)\in\ell^2(\ZZ)$ its inverse transform. An easy check using show that $\norm{v^0}_2=1$. Now take $n:=\lfloor T/k \rfloor$. Thus:
            \begin{align*}
              {\norm{v^n}_2}^2 & =\frac{h}{2\pi}\int_{-\pi/h}^{\pi/h} \abs{\hat{v}^n(\xi)}^2\dd{\xi}                        \\
                               & =\frac{h}{2\pi}\int_{-\pi/h}^{\pi/h} \abs{g(h\xi, k,h)}^{2n}\abs{\hat{v}^0(\xi)}^2\dd{\xi} \\
                               & >{(1+Kk)}^{2n}                                                                             \\
                               & >{(1+Kk)}^{\frac{2}{k}}                                                                    \\
                               & ={\left({(1+Kk)}^{\frac{1}{Kk}}\right)}^{2K}                                               \\
                               & \geq 2^{2K}                                                                                \\
                               & =2^{2K}{\norm{v^0}_2}^2
            \end{align*}
            where the penultimate step is because $\inf_{x\in[0,1]}{(1+x)}^{1/x}=2$.
            Hence the scheme is unstable.
    \end{enumerate}
  \end{proof}
  \begin{corollary}
    Let $P_{k,h}{v}={f}$ be a one-step finite difference scheme with constant coefficients whose amplification factor $g(\theta,k,h)$ is continuous on $\RR\times\Lambda$, where $(k,h)\in\Lambda$ is a stability region. Then:
    \begin{enumerate}
      \item If $\abs{g(\theta,k,h)}\leq 1$ $\forall \theta$ and $\forall(k,h)\in\Lambda$, then the scheme is stable.
      \item If $\exists\theta_0\in\RR$ and $\delta>0$ such that $\abs{g(\theta_0,k,h)}>1+\delta$ $\forall(k,h)\in\Lambda$, then the scheme is unstable.
    \end{enumerate}
  \end{corollary}
  \begin{proposition}[Lax-Wendroff]
    Consider the traffic equation of \mcref{NIPDE:traffic}.
    The \emph{Lax-Wendroff scheme} is:
    \begin{multline*}
      \frac{u_m^{n+1}-u_{m}^n}{k}+a\frac{u_{m+1}^{n}-u_{m-1}^n}{2h}+\frac{a^2k}{2}\frac{u_{m+1}^n-2u_m^n+u_{m-1}^n}{h^2} \\ =\frac{f_m^{n+1}+f_m^n}{2}-\frac{ak}{4}\frac{f_{m+1}^n-f_{m-1}^n}{h}+\O{k^2}+\O{h^2}
    \end{multline*}
  \end{proposition}
  \begin{sproof}
    Expand $u(t+k,x)$ in Taylor series and use that:
    \begin{align*}
      u_t    & =-au_x+f            \\
      u_{tt} & =a^2u_{xx}-af_x+f_t
    \end{align*}
  \end{sproof}
  \begin{proposition}
    The Lax-Wendroff scheme is a one-step method that has order of consistency 2.
  \end{proposition}
  \begin{sproof}
    Show that $P_{k,h}\phi-R_{k,h}P\phi=\O{h^2}+\O{k^2}$ using a Taylor expansion and is stable if $a\lambda\leq 1$.
  \end{sproof}
  \begin{proposition}[Crank-Nicolson]
    Consider the traffic equation of \mcref{NIPDE:traffic}.
    The \emph{Crank-Nicolson scheme} is:
    \begin{multline*}
      \frac{u_m^{n+1}-u_{m}^n}{k}+a\frac{u_{m+1}^{n+1}-u_{m-1}^{n+1}+u_{m+1}^{n}-u_{m-1}^{n}}{4h}=\\ =\frac{f_m^{n+1}+f_m^n}{2}+\O{k^2}+\O{h^2}
    \end{multline*}
    Note that it is an implicit scheme.
  \end{proposition}
  \begin{proposition}
    The Crank-Nicolson scheme is a one-step method that has order of consistency 2 and it is unconditionally stable.
  \end{proposition}
  \begin{sproof}
    An easy check shows that:
    $$P_{k,h}\phi-R_{k,h}P\phi=\O{{(k+h)}^2}+\O{\frac{k^3}{h}}$$
    For the stability...
  \end{sproof}
  \begin{definition}
    Given scheme $P_{k,h}{v}={f}$, usually we cannot use the recurrence to compute the last term of the (finite) grid, with $n\in\{0,\ldots,N\}$ and $m\in\{0,\ldots,M\}$, $v_M^{n}$ for each $n\in\NN$. Thus the \emph{numerical boundary condition} is used in this cases. A numerical solution of order $p$ is a extrapolation of order $\O{h^p}$ of the last term of the grid in terms of the orther ones. Each $u(t,x-\ell h)$ can be expressed as: $$u(t,x-\ell h)=\sum_{k=1}^{p-1}\frac{{(-1)}^k \ell^kh^k}{k!}u^{(k)}+\O{h^p}$$
    If we want to get a linear approximation of the form
    $$u(t,x)=\sum_{k=1}^{p}\lambda_ku(x-kh)$$
    we need to solve the following linear system:
    $$
      \begin{pmatrix}
        1      & 1       & \cdots & 1             \\
        1      & 2       & \cdots & {(p-1)}       \\
        \vdots & \vdots  & \ddots & \vdots        \\
        1      & 2^{p-1} & \cdots & {(p-1)}^{p-1}
      \end{pmatrix}
      \begin{pmatrix}
        \lambda_1 \\
        \lambda_2 \\
        \vdots    \\
        \lambda_p
      \end{pmatrix}=
      \begin{pmatrix}
        1      \\
        0      \\
        \vdots \\
        0
      \end{pmatrix}
    $$
    Note that the solution always exists because the matrix is a Vandermonde matrix.
    For example, numerical boundary conditions of order 1, 2 and 3 are respectively:
    \begin{align*}
      v_M^{n} & =v_{M-1}^{n}                           \\
      v_M^n   & =2v_{M-1}^{n}-v_{M-2}^{n}              \\
      v_M^n   & =3v_{M-1}^{n}-3v_{M-2}^{n}+v_{M-3}^{n}
    \end{align*}
  \end{definition}
  \begin{proposition}\label{NIPDE:preLax}
    Consider the following initial value and boundary problem with constant coefficients:
    \begin{equation}\label{NIPDE:eqLax}
      \begin{cases}
        u_t=L(u)                                                                                                                    \\
        u(0,\vf{x})=u_0(\vf{x}) & \!\text{if }\vf{x}\in\Omega \subseteq\RR^n                                                        \\
        u(t,\vf{x})=g(t,\vf{x}) & \!\text{if }(t,\vf{x})\in[0,\infty)\times\partial\Omega_1\subseteq [0,\infty)\times\partial\Omega
      \end{cases}
    \end{equation}
    where $L$ is a differential operator and $g$ is a function. Let $M(\Omega)$ be the set of indices that we compute $\vf{v}^n=(v_m^n)_{m\in M(\Omega)}$. Consider a finite difference scheme of the form
    \begin{equation}\label{NIPDE:eqpreLax}
      \vf{B}_1\vf{v}^{n+1}=\vf{B}_0\vf{v}^n+\vf{f}^n
    \end{equation}
    where $\vf{B}_0$ and $\vf{B}_1$ are matrices and $\vf{f}^n$ is a vector. Then, the scheme is stable with stability region $\Lambda\subseteq \RR_{\geq 0}\times\RR$ if and only if $\forall T>0$ $\exists C_T>0$ such that $\forall (k,h)\in\Lambda$ and $\forall \ell\in\NN$ with $0\leq \ell k\leq T$ we have $\norm{{\left({\vf{B}_1}^{-1}\vf{B}_0\right)}^\ell}\leq C_T$.
  \end{proposition}
  \begin{proof}
    \begin{itemizeiff}
      We will prove by contradiction. Suppose that $\exists T>0$ such that $\forall C_T>0$ exist $(k,h)\in \Lambda$ and $\ell \in \NN$ with $0\leq \ell k\leq T$ such that $\norm{{\left({\vf{B}_1}^{-1}\vf{B}_0\right)}^\ell}> C_T$. Let $\vf{A}:= {\left({\vf{B}_1}^{-1}\vf{B}_0\right)}^\ell$. Then, taking $\vf{x^*}$ such that $\norm{\vf{x^*}}=1$ and $\norm{A}=\norm{\vf{A}\vf{x^*}}$ we have that for any $\vf{v}^0$, defining $\vf{w}^0:=\vf{v}^0+\vf{x^*}$ we have that:
      \begin{multline*}
        \norm{\vf{v}^\ell -\vf{w}^\ell}= \norm{\vf{A} \vf{x^*}}=\norm{A}>C_T\norm{\vf{v}^0-\vf{w}^0}
      \end{multline*}
      where the first equality follows from expanding recursively the norm $\norm{\vf{v}^\ell -\vf{w}^\ell}$. Hence the scheme is not stable.
      \item An easy check show that if $\vf{v}^0$ and $\vf{w}^0$ are such that satisfy the recurrence of \mcref{NIPDE:eqpreLax}, then ${\vf{v}^\ell -\vf{w}^\ell}=\vf{A}(\vf{v}^0-\vf{w}^0)$. So if
      $$
        \norm{\vf{v}^\ell -\vf{w}^\ell}\leq C_T\norm{\vf{v}^0-\vf{w}^0}
      $$
      then necessarily $\norm{\vf{A}}\leq C_T$.
    \end{itemizeiff}
  \end{proof}
  \begin{theorem}[Lax-Richtmyer equivalence theorem]
    Consider the problem of \mcref{NIPDE:eqLax} and define
    $$
      \vf{T}^n:=\vf{B}_1\vf{u}^{n+1}-\vf{B}_0\vf{u}^n -\vf{f}^n
    $$
    Suppose that:
    \begin{enumerate}
      \item $\norm{\vf{T}^n}=\O{k^p+\norm{\vf{h}}^q}$ independent of $n$ and $\forall (k,h)\in\Lambda$ and all $(t,x)\in[0,T]\times\Omega$.
      \item $\forall (k,h)\in\Lambda$, $\vf{B}_1$ is invertible and $\norm{{\vf{B}_1}^{-1}}\leq C_1k$ for certain $C_1>0$ independent of $(k,h)$.
      \item The scheme is stable.
      \item $\vf{v}^0$ is such that $\norm{\vf{v}^0-\vf{u}^0}=\O{k^p+\norm{\vf{h}}^q}$ uniformly for $(k,h)\in\Lambda$ and $(t,x)\in[0,T]\times\Omega$.
    \end{enumerate}
    Then, $\forall n\in\NN$ with $0\leq nk\leq T$ we have:
    $$
      \norm{\vf{v}^n-\vf{u}^n}=\O{k^p+\norm{\vf{h}}^q}
    $$
    uniformly for $(k,h)\in\Lambda$ and $(t,x)\in[0,T]\times\Omega$.
  \end{theorem}
  \begin{proof}
    We have that
    \begin{align*}
      \vf{B}_1\vf{v}^{n} & =\vf{B}_0\vf{v}^{n-1}+\vf{f}^{n-1}               \\
      \vf{B}_1\vf{u}^{n} & =\vf{B}_0\vf{u}^{n-1} +\vf{f}^{n-1}+\vf{T}^{n-1}
    \end{align*}
    Then if $\vf{A}= {\vf{B}_1}^{-1}\vf{B}_0$ we have that
    $$\vf{v}^n-\vf{u}^n=\vf{A}^n(\vf{v}^0-\vf{u}^0)-\sum_{\ell=0}^{n-1}\vf{A}^{n-1-\ell}{\vf{B_1}}^{-1}\vf{T}^\ell$$
    And so:
    $$
      \norm{\vf{v}^n-\vf{u}^n}\leq C_T \O{k^p+\norm{\vf{h}}^q}+\sum_{\ell=0}^{n-1}C_T C_1k\O{k^p+\norm{\vf{h}}^q}
    $$
    where we have used \mcref{NIPDE:preLax} for noting that $\forall\ell=0,\ldots,n-1$ $\norm{\vf{A}^{n-1-\ell}}\leq C_T$.
    Finally observe that $kn\leq T$ and the uniformity of the $\O{k^p+\norm{\vf{h}}^q}$ allows us to conclude the proof.
  \end{proof}
  \begin{remark}
    It can also be shown that the consistency and convergency imply stability.
  \end{remark}
  \begin{theorem}
    Consider a scheme of $J$ steps for a 1st-order-in-time linear pde of constant coefficients whose amplification factor is $g$. Let $\Phi(\theta, g)$ be the \emph{amplification polynomial}, that is the polynomial that satisfies $g$ of degree $J-1$. Then, the scheme is stable if and only if for any root $g_j(\theta)$ of $\Phi$ we have $\abs{g_j(\theta)}\leq 1$ and if $\exists \theta_0$ and $k$ such that $\abs{g_k(\theta_0)}=1$ then this root is simple.
  \end{theorem}
\end{multicols}
\end{document}